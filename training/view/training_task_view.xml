<openerp>
    <data>
        <record id="view_training_task_search" model="ir.ui.view">
            <field name="name">view_training_task_search</field>
            <field name="model">training.task</field>
            <field name="arch" type="xml">
                <search>
                    <field name="name"/>
                    <field name="parent_id"/>
                    <filter name="root_task" string="Root Task" domain="[('parent_id', '=', False)]"/>
                    <filter name="pending_task" string="Pending Task" domain="[('state', '=', 'pending')]"/>
                </search>
            </field>
        </record>

        <record id="view_training_task_tree" model="ir.ui.view">
            <field name="name">view_training_task_tree</field>
            <field name="model">training.task</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="sequence" widget="handle"/>
                    <field name="name"/>
                    <!-- <field name="start_date"/> -->
                    <field name="url" widget="url" invisible="1"/>
                    <field name="task_total"/>
                    <field name="task_done"/>
                    <field name="state"/>
                    <field name="trainee_id"/>
                    <!-- <button string="action_new_training" type="object" name="new_training"/> -->
<!--                     <button string="Pending" type="object" name="action_state_pending" states="done"/> -->
                    <button string="Done" type="object" name="action_state_done" states="pending"/>
                    <button string="Open Link" type="object" name="action_open_url" attrs="{'invisible':[('url', '=', False)]}"/>
                </tree>
            </field>
        </record>
        <record id="view_training_task_template_form" model="ir.ui.view">
            <field name="name">view_training_task_template_form</field>
            <field name="model">training.task</field>
            <field name="priority" eval="99"/>
            <field name="arch" type="xml">
                <form>
                    <field name="parent_id" invisible="1"/>
                    <header>
                        <field name="state" widget="statusbar" clickable="True" invisible="1"/>
                    </header>
                    <sheet>
                        <h1>
                            <field name="name" placeholder="Name..."/>
                        </h1>
                        <group>
                            <group>
                                <field name="type"/>
                                <!-- <field name="trainee_id" attrs="{'invisible':[('parent_id', '!=', False)]}" domain="[('is_company','=',0)]"/> -->
                                <!-- <field name="trainer_id" attrs="{'invisible':[('type', '!=', 'view')]}"/> -->
                                <field name="url" widget="url" attrs="{'invisible':[('type', '=', 'view')]}"/>
                            </group>
                            <group>
                                <field name="task_total"/>
                                <!-- <field name="task_done"/> -->
                            </group>
                            <!-- <field name="start_date" attrs="{'invisible': [('type', 'in', ('view','tutorial'))], 'required': [('type', '!=', 'view')]}"/> -->
                        </group>
                        <notebook>
                            <page string="Childs" attrs="{'invisible':[('type', '!=', 'view')]}">
                                <field name="child_ids">
                                    <tree editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="name"/>
                                        <field name="type"/>
                                        <field name="url" attrs="{'invisible': [('type', '=', 'view')]}"/>
                                        <field name="state" invisible="1"/>
                                        <button string="open" name="action_open_task" type="object"/>
                                    </tree>
                                </field>
                                <!-- <field name="child_ids" context="{'tree_view_ref': 'training.view_training_task_template_form'}"/> -->
                            </page>
                            <page string="Description">
                                <field name="description"/>
                            </page>
                            <page string="Aditional Info" attrs="{'invisible':[('type', '=', 'view')]}">
                                <!-- <field name="end_date"/> -->
                                <field name="sequence"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="view_training_task_form" model="ir.ui.view">
            <field name="name">view_training_task_form</field>
            <field name="model">training.task</field>
            <field name="inherit_id" ref="view_training_task_template_form"/>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
                <field name="state" position="attributes">
                    <attribute name="invisible">False</attribute>
                </field>
                <!-- <header position="inside"> -->
                <!-- </header> -->
                <notebook>
                    <page string="Solution" attrs="{'invisible':[('type', '!=', 'exercise')]}">
                        <field name="solution"/>
                    </page>
                </notebook>
                <field name="type" position="after">
                    <field name="trainee_id" attrs="{'invisible':[('parent_id', '!=', False)]}" required="True" domain="[('is_company','=',0)]"/>
                    <field name="trainer_id" attrs="{'invisible':[('type', '!=', 'view')]}" required="True"/>
                </field>
                <field name="child_ids" position="attributes">
                        <attributes name="context=">{'default_trainee_id': trainee_id, 'default_parent_id': parent_id}"</attributes>
                        <field name="state" position="attributes">
                            <attribute name="invisible">False</attribute>
                        </field>                 
                </field>
<!--                 <xpath expr="//field[@name='state']" position="attributes">
                    <attributes name="invisible">False</attributes>
                </xpath> -->
<!--                 <xpath expr="//button[@string='open']" position="replace">
                    <button string="open" name="action_open_template_task" type="object" position="replace">
                        <button string="Open2" name="action_open_task" type="object"/>
                 </button>
                </xpath> -->
                <field name="task_total" position="after">
                    <field name="task_done"/>
                    <field name="trainee_user_id"/>
                </field>
                <field name="solution" position="after">
                    <field name="end_date"/>
                </field>
            </field>
        </record>
        <record id="view_training_task_kanban" model="ir.ui.view">
            <field name="name">view_training_task_kanban</field>
            <field name="model">training.task</field>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
            <kanban>
                <template>
                    <field name="trainee_user_id"/>
                </template>
            </kanban>
            </field>
        </record>    
        <record id="action_training_task" model="ir.actions.act_window">
            <field name="name">My Trainings</field>
            <field name="res_model">training.task</field>
            <field name="context">{'search_default_pending_task': 1}</field>
            <field name="domain">[('state', '!=', 'template'), ('trainee_user_id','=',uid)]</field>
        </record>
        <record id="action_pending_task" model="ir.actions.act_window">
            <field name="name">My Trainees</field>
            <field name="res_model">training.task</field>
            <field name="context">{'search_default_root_task': 1}</field>
            <field name="domain">[('state', '!=', 'template'),('trainer_id','=',uid)]</field>
        </record>
        <record id="action_training_task_template" model="ir.actions.act_window">
            <field name="name">Training Task Templates</field>
            <field name="res_model">training.task</field>
            <field name="domain">[('state', '=', 'template'),('parent_id', '=', False)]
            </field>
<!--             <field name="view_mode">tree</field>
            <field name="view_id" ref="view_training_task_template_form"/> -->
        </record>
        <record id="action_training_task_template_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_training_task_tree"/>
            <field name="act_window_id" ref="action_training_task_template"/>
        </record>
<!--         <record id="action_training_task_template_form" model="ir.actions.act_window.view">
            <field eval="10" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_training_task_template_form"/>
            <field name="act_window_id" ref="action_training_task_template"/>
        </record> -->
        <record id="view_training_task_kanban" model="ir.actions.act_window.view">
            <field eval="10" name="sequence"/>
            <field name="view_mode">kanban</field>
            <field name="view_id" ref="view_training_task_kanban"/>
            <field name="act_window_id" ref="action_training_task_template"/>
        </record>
        <record id="action_config_training_task" model="ir.actions.act_window">
            <field name="name">action_config_training_task</field>
            <field name="res_model">training.task</field>
            <field name="context">{'search_default_root_task': 1}</field>
            <field name="domain">[('state', '!=', 'template')]</field>
        </record>
        <menuitem
            id="menu_training"
            name="Training"
        />
        <menuitem 
            id="menu_parent_training"
            name="Menu Trainings"
            parent="menu_training"
        />
        <menuitem 
            id="menu_config_training"
            name="Configuration"
            parent="menu_training"
        />
        <menuitem 
            id="action_conf_training"
            name="Training Tasks"
            parent="menu_config_training"
            action="action_config_training_task"
        />
        <menuitem
            id="parent_training_template"
            parent="menu_config_training"
            action="action_training_task_template"
        />
        <menuitem
            id="parent_training"
            parent="menu_parent_training"
            action="action_training_task"
        />
        <menuitem
            id="pending_task"
            parent="menu_parent_training"
            action="action_pending_task"
        />
    </data>
</openerp>